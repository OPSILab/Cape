{"openapi":"3.0.1","info":{"title":"SDK Service API","description":"SDK Service API for integration with cape","version":"2.0"},"servers":[{"url":"http://localhost:8085/cape-service-sdk","description":"Generated server url"}],"security":[{"bearer-key":[]}],"tags":[{"name":"Service Linking","description":"Cape SDK APIs to handle Service Linking internal operations."},{"name":"Service Management","description":"Cape SDK APIs to handle Services managed by this SDK"},{"name":"Service Link Record","description":"Cape SDK APIs to manage Service Link Records."},{"name":"Consenting","description":"Consent Manager APIs to perform CaPe Consenting operations."}],"paths":{"/api/v2/idm/user":{"get":{"tags":["authentication-controller"],"operationId":"getUserDetails","parameters":[{"name":"token","in":"query","required":true,"schema":{"type":"string"}}],"responses":{"500":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"default response","content":{"*/*":{"schema":{"type":"object"}}}}}}},"/api/v2/idm/auth/external_logout":{"delete":{"tags":["authentication-controller"],"operationId":"externalLogout","parameters":[{"name":"client_id","in":"query","required":true,"schema":{"type":"string"}}],"responses":{"500":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"default response","content":{"*/*":{"schema":{"type":"object"}}}}}}},"/api/v2/idm/oauth2/token":{"post":{"tags":["authentication-controller"],"operationId":"postCodeforToken","parameters":[{"name":"grant_type","in":"query","required":true,"schema":{"type":"string"}},{"name":"redirect_uri","in":"query","required":true,"schema":{"type":"string"}},{"name":"code","in":"query","required":true,"schema":{"type":"string"}}],"responses":{"500":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"default response","content":{"*/*":{"schema":{"type":"object"}}}}}}},"/api/v2/services/{serviceId}":{"get":{"tags":["Service Management"],"summary":"Get service by ServiceId (optionally only the ones registered to CaPe) managed by this SDK","description":"Get service managed by this SDK","operationId":"getService","parameters":[{"name":"serviceId","in":"path","required":true,"schema":{"type":"string"}},{"name":"onlyRegistered","in":"query","required":false,"schema":{"type":"boolean","default":false}}],"responses":{"500":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"Returns 200 OK and the list of registered services","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ServiceEntry"}}}}}},"post":{"tags":["Service Management"],"summary":"Register a Service existing in the Service Registry as managed by CaPe.","description":"Register the Service as managed by this SDK and create Service key pair and x509 Certificate","operationId":"registerServiceToCape","parameters":[{"name":"serviceId","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"500":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"201":{"description":"Returns 201 CREATED and the Service Description containing generated Public X509 Certificate.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ServiceEntry"}}}}}},"delete":{"tags":["Service Management"],"summary":"Unregister a Service managed by CaPe. Optionally delete also Service Description from Service Registry","description":"Delete Service Sign key pair (and PoP key if Sink) and cert from Service Description at Registry","operationId":"unregisterService","parameters":[{"name":"serviceId","in":"path","required":true,"schema":{"type":"string"}},{"name":"deleteServiceDescription","in":"query","required":false,"schema":{"type":"boolean","default":false}}],"responses":{"500":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Returns 404, no Service or Sign Key was found","content":{"*/*":{"schema":{"type":"object"}}}},"400":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"204":{"description":"Returns 204 No Content","content":{"*/*":{"schema":{"type":"object"}}}}}}},"/api/v2/services":{"get":{"tags":["Service Management"],"summary":"Get services (optionally only the ones registered to CaPe) managed by this SDK","description":"Get services managed by this SDK","operationId":"getServices","parameters":[{"name":"onlyRegistered","in":"query","required":false,"schema":{"type":"boolean","default":false}}],"responses":{"500":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"Returns 200 OK and the list of registered services","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ServiceEntry"}}}}}}},"/api/v2/slr/linking/code":{"get":{"tags":["Service Linking"],"summary":"Get Linking code from Service Manager for automatic linking starting","operationId":"getLinkSessionCode","parameters":[{"name":"serviceId","in":"query","required":true,"schema":{"type":"string"}},{"name":"userId","in":"query","required":true,"schema":{"type":"string"}},{"name":"surrogateId","in":"query","required":true,"schema":{"type":"string"}},{"name":"returnUrl","in":"query","required":true,"schema":{"type":"string"}},{"name":"forceLinking","in":"query","required":true,"schema":{"type":"boolean"}}],"responses":{"500":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"Returns the requested linking code.","content":{"application/json":{}}}}}},"/api/v2/slr/{slrId}/surrogate/{surrogateId}/services/{serviceId}":{"put":{"tags":["Service Linking"],"summary":"Notify to the Service a status change in a Service Link Record.","operationId":"enableServiceLink","parameters":[{"name":"slrId","in":"path","required":true,"schema":{"type":"string"}},{"name":"surrogateId","in":"path","required":true,"schema":{"type":"string"}},{"name":"serviceId","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"500":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"201":{"description":"Returns 201 Created.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ServiceLinkStatusRecordSigned"}}}}}},"delete":{"tags":["Service Linking"],"summary":"Notify to the Service a status change in a Service Link Record.","operationId":"disableServiceLink","parameters":[{"name":"slrId","in":"path","required":true,"schema":{"type":"string"}},{"name":"surrogateId","in":"path","required":true,"schema":{"type":"string"}},{"name":"serviceId","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"500":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"201":{"description":"Returns 201 Created.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ServiceLinkStatusRecordSigned"}}}}}}},"/api/v2/users/{surrogateId}/service/{serviceId}/purpose/{purposeId}/consentForm":{"get":{"tags":["Consenting"],"summary":"Call Consent Manager to generate Consent Form for surrogateId, sinkId and sourceId (if any) in input.","operationId":"fetchConsentForm","parameters":[{"name":"surrogateId","in":"path","required":true,"schema":{"type":"string"}},{"name":"serviceId","in":"path","required":true,"schema":{"type":"string"}},{"name":"purposeId","in":"path","required":true,"schema":{"type":"string"}},{"name":"sourceDatasetId","in":"query","required":true,"schema":{"type":"string"}},{"name":"sourceServiceId","in":"query","required":true,"schema":{"type":"string"}}],"responses":{"500":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"Returns the generated Consent Form containing the Resource Set generated either by matching Sink and Source datasets' mappings (3-party reuse) or from the datasets of the service (Within Service)","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ConsentForm"}}}}}}},"/api/v2/users/{surrogateId}/consents":{"get":{"tags":["Consent Record"],"summary":"Get the list of signed Consent Records for the input Surrogate Id.","operationId":"getConsentRecordsBySurrogateId","parameters":[{"name":"surrogateId","in":"path","required":true,"schema":{"type":"string"}},{"name":"checkConsentAtOperator","in":"query","required":false,"schema":{"type":"boolean","default":false}}],"responses":{"500":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"Returns the list of signed Consent Records belonging to the User linked with the input Surrogate Id","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ConsentRecordSigned"}}}}}}},"post":{"tags":["Consenting"],"summary":"Give the Consent for the input ConsentForm. Return Consent Record signed with the Acccount private key.","operationId":"giveConsent","parameters":[{"name":"surrogateId","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ConsentForm"}}},"required":true},"responses":{"500":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"201":{"description":"Returns 201 Created with the created Consent Record Signed.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ConsentRecordSigned"}}}}}}},"/api/v2/services/consents":{"get":{"tags":["Consent Record"],"summary":"Get the list of all signed Consent Records for this Service Provider.","operationId":"getConsentRecords","parameters":[{"name":"checkConsentAtOperator","in":"query","required":false,"schema":{"type":"boolean","default":false}}],"responses":{"500":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"Returns the list of signed Consent Records for all the Users for services provided by this Service Provieder (SDK instance).","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ConsentRecordSigned"}}}}}}}},"/api/v2/dc":{"post":{"tags":["Data Request"],"summary":"End point that initialises Data Transfer flow from Sink.","operationId":"startDataTransfer","parameters":[{"name":"checkConsentAtOperator","in":"query","required":true,"schema":{"type":"boolean"}},{"name":"dataset_id","in":"query","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DataTransferRequest"}}},"required":true},"responses":{"500":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"Returns 200 OK with the Data requested matching input Rs id.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DataTransferResponse"}}}}}}},"/api/v2/dc/send":{"post":{"tags":["Data Request"],"summary":"Final End point to get Data Transfer at the Source.","operationId":"postDataTransfer","parameters":[{"name":"dataset_id","in":"query","required":true,"schema":{"type":"string"}},{"name":"Authorization","in":"header","required":true,"schema":{"type":"array","items":{"type":"string"}}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DataTransferRequest"}}},"required":true},"responses":{"500":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"Returns 200 OK with the Data requested matching input Rs id.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DataTransferResponse"}}}}}}},"/api/v2/slr/surrogate_id":{"get":{"tags":["Service Linking"],"summary":"Generate surrogate_id for given CaPe Account and Service Account.","description":"Generate surrogate_id","operationId":"generateSurrogateId","parameters":[{"name":"operatorId","in":"query","required":true,"schema":{"type":"string"}},{"name":"userId","in":"query","required":true,"schema":{"type":"string"}}],"responses":{"500":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"201":{"description":"Returns 201 CREATED and the created surrogate_id ","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SurrogateIdResponse"}}}}}}},"/api/v2/services/signKeys":{"get":{"tags":["Service Management"],"summary":"Get sign keys of services registered to Cape by this SDK","description":"Get registered services sign keys managed by this SDK","operationId":"getRegisteredServicesKeys","responses":{"500":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"Returns 200 OK and the list of registered services","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ServiceSignKey"}}}}}}},"/api/v2/userSurrogateIdLink":{"get":{"tags":["Service Link Record"],"summary":"Return the Last Service Link Record Status by Slr Id.","operationId":"getUserSurrogateLinkByUserIdAndServiceIdAndOperatorId","parameters":[{"name":"userId","in":"query","required":true,"schema":{"type":"string"}},{"name":"serviceId","in":"query","required":true,"schema":{"type":"string"}},{"name":"operatorId","in":"query","required":true,"schema":{"type":"string"}}],"responses":{"500":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"Returns the Last Service Link Record Status.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ServiceLinkStatusRecordSigned"}}}}}},"post":{"tags":["Service Linking"],"summary":"Insert a new link between userId, surrogateId, serviceId and operatorId.","operationId":"linkUserToSurrogateId","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserSurrogateIdLink"}}},"required":true},"responses":{"500":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"201":{"description":"Returns 201 CREATED and the created UserSurrogateIdLink.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserSurrogateIdLink"}}}}}}},"/api/v2/slr/{slrId}/status":{"post":{"tags":["Service Linking"],"summary":"Notify to the Service a status change in a Service Link Record.","operationId":"notifyServiceLinkStatusChanged","parameters":[{"name":"slrId","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ServiceLinkStatusRecordSigned"}}},"required":true},"responses":{"500":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"201":{"description":"Returns 201 Created.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ServiceLinkStatusRecordSigned"}}}}}}},"/api/v2/services/{serviceId}/consents":{"get":{"tags":["Consent Record"],"summary":"Get the list of signed Consent Records for the input Service Id.","operationId":"getConsentRecordsByServiceId","parameters":[{"name":"serviceId","in":"path","required":true,"schema":{"type":"string"}},{"name":"checkConsentAtOperator","in":"query","required":false,"schema":{"type":"boolean","default":false}}],"responses":{"500":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"Returns the list of signed Consent Records for all the Users linked with the input ServiceId","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ConsentRecordSigned"}}}}}}}},"/api/v2/services/{serviceId}/slr":{"get":{"tags":["Service Link Record"],"summary":"Return Service Link Records by Service Id","operationId":"getServiceLinkRecordsByServiceId","parameters":[{"name":"serviceId","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"500":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"Returns Service Link Records.","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ServiceLinkRecordDoubleSigned"}}}}}}}},"/api/v2/slr/{slrId}":{"get":{"tags":["Service Link Record"],"summary":"Return Service Link Records by Slr Id","operationId":"getServiceLinkRecordBySlrId","parameters":[{"name":"slrId","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"500":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"Returns the Service Link Record.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ServiceLinkRecordDoubleSigned"}}}}}}},"/api/v2/slr/{slrId}/statuses/last":{"get":{"tags":["Service Link Record"],"summary":"Return the Last Service Link Record Status by Slr Id.","operationId":"getLastServiceLinkStatusRecord","parameters":[{"name":"slrId","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"500":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"Returns the Last Service Link Record Status.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ServiceLinkStatusRecordSigned"}}}}}}},"/api/v2/cr/cr_management":{"post":{"tags":["Consenting"],"summary":"Verify and store a new Consent Record issued by the Operator.","operationId":"storeNewConsentRecord","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ConsentRecordSigned"}}},"required":true},"responses":{"500":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"201":{"description":"Returns 201 Created.","content":{"text/plain":{}}}}},"patch":{"tags":["Consenting"],"summary":"Verify and update the Consent Record (along with new Csr as last one in the csr list) issued by the Consent Manager.","operationId":"updateConsentRecordWithNewStatus","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ConsentRecordSigned"}}},"required":true},"responses":{"500":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"201":{"description":"Returns 201 Created.","content":{"text/plain":{}}}}}},"/api/v2/slr":{"get":{"tags":["Service Link Record"],"summary":"Return all the Service Link Records","operationId":"getAllServiceLinkRecords","responses":{"500":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"Returns Service Link Records.","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ServiceLinkRecordDoubleSigned"}}}}}}}},"/api/v2/slr/linking":{"post":{"tags":["Service Linking"],"summary":"Link Service Account to CaPe Account","description":"Initiate linking process","operationId":"startServiceLinking","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/StartLinkingRequest"}}},"required":true},"responses":{"500":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"201":{"description":"Returns 201 CREATED and the created Service Link Record and Service Link Status Record","content":{"application/json":{"schema":{"$ref":"#/components/schemas/FinalLinkingResponse"}}}}}}},"/api/v2/users/{surrogateId}/servicelinks/{slrId}/consents/{crId}/statuses":{"post":{"tags":["Consenting"],"summary":"Call the Consent Manager to change status (from Service) of a Consent for the input SurrogateId, Slr Id and Cr Id.","operationId":"changeConsentStatusFromService","parameters":[{"name":"surrogateId","in":"path","required":true,"schema":{"type":"string"}},{"name":"slrId","in":"path","required":true,"schema":{"type":"string"}},{"name":"crId","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChangeConsentStatusRequest"}}},"required":true},"responses":{"500":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"201":{"description":"Returns 201 Created with the new Consent Status Record Signed.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ConsentStatusRecordSigned"}}}}}}},"/api/v2/slr/slr":{"post":{"tags":["Service Linking"],"summary":"Sign the Service Link Record payload with Service key.","description":"Sign the Service Link Record payload with Service key after verifying Account signature","operationId":"signServiceLinkRecordPayload","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ServiceSignSlrRequest"}}},"required":true},"responses":{"500":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"201":{"description":"Returns 201 CREATED and the created Service Description containing generated Public X509 Certificate.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ServiceEntry"}}}}}}},"/api/v2/operatorDescriptions/{operatorId}":{"get":{"tags":["Operator Description"],"summary":"Get Operator Description for CaPe by Operator Id","operationId":"getOperatorDescription","parameters":[{"name":"operatorId","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"500":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"Returns the requested Operator Description.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OperatorDescription"}}}}}}},"/api/v2/slr/surrogate/{surrogateId}":{"get":{"tags":["Service Link Record"],"summary":"Return Service Link Records by Surrogate Id","operationId":"getServiceLinkRecordBySurrogateId","parameters":[{"name":"surrogateId","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"500":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"Returns the Service Link Record.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ServiceLinkRecordDoubleSigned"}}}}}}},"/api/v2/slr/surrogate/{surrogateId}/services/{serviceId}":{"get":{"tags":["Service Link Record"],"summary":"Return Service Link Records by Surrogate Id and Service Id","operationId":"getServiceLinkRecordBySurrogateIdAndServiceId","parameters":[{"name":"surrogateId","in":"path","required":true,"schema":{"type":"string"}},{"name":"serviceId","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"500":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"Returns the Service Link Record.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ServiceLinkRecordDoubleSigned"}}}}}}},"/api/v2/users/{surrogateId}/purpose/{purposeId}/consent":{"get":{"tags":["Consent Record"],"summary":"Get the list of signed Consent Records for the input Surrogate Id.","operationId":"getConsentRecordsBySurrogateIdAndPurposeId","parameters":[{"name":"surrogateId","in":"path","required":true,"schema":{"type":"string"}},{"name":"purposeId","in":"path","required":true,"schema":{"type":"string"}},{"name":"checkConsentAtOperator","in":"query","required":false,"schema":{"type":"boolean","default":false}}],"responses":{"500":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"Returns the list of signed Consent Records belonging to the User linked with the input Surrogate Id and Purpose Id","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ConsentRecordSigned"}}}}}}}}},"components":{"schemas":{"ApiSubError":{"required":["type"],"type":"object","properties":{"type":{"type":"string"}},"discriminator":{"propertyName":"type"}},"ErrorResponse":{"type":"object","properties":{"status":{"type":"string","enum":["100 CONTINUE","101 SWITCHING_PROTOCOLS","102 PROCESSING","103 CHECKPOINT","200 OK","201 CREATED","202 ACCEPTED","203 NON_AUTHORITATIVE_INFORMATION","204 NO_CONTENT","205 RESET_CONTENT","206 PARTIAL_CONTENT","207 MULTI_STATUS","208 ALREADY_REPORTED","226 IM_USED","300 MULTIPLE_CHOICES","301 MOVED_PERMANENTLY","302 FOUND","302 MOVED_TEMPORARILY","303 SEE_OTHER","304 NOT_MODIFIED","305 USE_PROXY","307 TEMPORARY_REDIRECT","308 PERMANENT_REDIRECT","400 BAD_REQUEST","401 UNAUTHORIZED","402 PAYMENT_REQUIRED","403 FORBIDDEN","404 NOT_FOUND","405 METHOD_NOT_ALLOWED","406 NOT_ACCEPTABLE","407 PROXY_AUTHENTICATION_REQUIRED","408 REQUEST_TIMEOUT","409 CONFLICT","410 GONE","411 LENGTH_REQUIRED","412 PRECONDITION_FAILED","413 PAYLOAD_TOO_LARGE","413 REQUEST_ENTITY_TOO_LARGE","414 URI_TOO_LONG","414 REQUEST_URI_TOO_LONG","415 UNSUPPORTED_MEDIA_TYPE","416 REQUESTED_RANGE_NOT_SATISFIABLE","417 EXPECTATION_FAILED","418 I_AM_A_TEAPOT","419 INSUFFICIENT_SPACE_ON_RESOURCE","420 METHOD_FAILURE","421 DESTINATION_LOCKED","422 UNPROCESSABLE_ENTITY","423 LOCKED","424 FAILED_DEPENDENCY","425 TOO_EARLY","426 UPGRADE_REQUIRED","428 PRECONDITION_REQUIRED","429 TOO_MANY_REQUESTS","431 REQUEST_HEADER_FIELDS_TOO_LARGE","451 UNAVAILABLE_FOR_LEGAL_REASONS","500 INTERNAL_SERVER_ERROR","501 NOT_IMPLEMENTED","502 BAD_GATEWAY","503 SERVICE_UNAVAILABLE","504 GATEWAY_TIMEOUT","505 HTTP_VERSION_NOT_SUPPORTED","506 VARIANT_ALSO_NEGOTIATES","507 INSUFFICIENT_STORAGE","508 LOOP_DETECTED","509 BANDWIDTH_LIMIT_EXCEEDED","510 NOT_EXTENDED","511 NETWORK_AUTHENTICATION_REQUIRED"]},"timestamp":{"type":"string","format":"date-time"},"message":{"type":"string"},"debugMessage":{"type":"string"},"cause":{"type":"string"},"subErrors":{"type":"array","items":{"$ref":"#/components/schemas/ApiSubError"}}}},"Cert":{"type":"object","properties":{"x5u":{"type":"string"},"x5c":{"type":"array","items":{"type":"string"}}}},"DataController":{"type":"object","properties":{"piiController":{"type":"string"},"onBehalf":{"type":"boolean"},"org":{"type":"string"},"contact":{"type":"string"},"address":{"type":"string"},"email":{"type":"string"},"phone":{"type":"string"},"operatorName":{"type":"string"}}},"DataMapping":{"type":"object","properties":{"property":{"type":"string"},"conceptId":{"type":"string"},"name":{"type":"string"},"type":{"type":"string"},"required":{"type":"boolean"}}},"DatasetSchema":{"type":"object","properties":{"context":{"type":"string"},"type":{"type":"string"},"id":{"type":"string"}}},"Description":{"type":"object","properties":{"locale":{"type":"string"},"description":{"type":"string"},"keyword":{"type":"array","items":{"type":"string"}}}},"Description__1":{"type":"object","properties":{"locale":{"type":"string"},"description":{"type":"string"}}},"Description__2":{"type":"object","properties":{"locale":{"type":"string"},"title":{"type":"string"},"description":{"type":"string"},"descriptionUrl":{"type":"string"},"iconUrl":{"type":"string"}}},"Distribution":{"type":"object","properties":{"distributionId":{"type":"string"},"accessUrl":{"type":"string"},"description":{"type":"array","items":{"$ref":"#/components/schemas/Description__1"}},"format":{"type":"string"}}},"HasCompetentAuthority":{"type":"object","properties":{"prefLabel":{"type":"string"},"spatial":{"type":"string"}}},"HumanReadableDescription":{"type":"object","properties":{"locale":{"type":"string"},"description":{"type":"string"},"keywords":{"type":"array","items":{"type":"string"}}}},"IsDescribedAt":{"type":"object","properties":{"datasetId":{"type":"string"},"description":{"type":"array","items":{"$ref":"#/components/schemas/Description"}},"datasetSchema":{"$ref":"#/components/schemas/DatasetSchema"},"dataStructureSpecification":{"type":"string"},"distribution":{"$ref":"#/components/schemas/Distribution"},"dataMapping":{"type":"array","items":{"$ref":"#/components/schemas/DataMapping"}}}},"Obligation":{"type":"object","properties":{"event":{"type":"string"},"activity":{"type":"string"}}},"ProcessingBasis":{"type":"object","properties":{"purposeId":{"type":"string"},"purposeName":{"type":"string"},"legalBasis":{"type":"string","enum":["Consent","Contract","Legal obligation","Vital interest","Public interest","Legitimate interest"]},"purposeCategory":{"type":"string","enum":["Academic Research","Access Control","Advertising ","CommercialInterest","CommercialResearch","CommunicationForCustomerCare","CreateEventRecommendations","CreatePersonalizedRecommendations","CreateProductRecommendations","CustomerCare","DeliveryOfGoods","DirectMarketing","FraudPreventionAndDetection","IdentityVerification","ImproveExistingProductsAndServices","ImproveInternalCRMProcesses","IncreaseServiceRobustness","InternalResourceOptimisation","LegalCompliance","Marketing","NonCommercialResearch","OptimisationForConsumer","OptimisationForController","OptimiseUserInterface","Payment","PersonalisedAdvertising","PersonalisedBenefits","RegistrationAuthentication","ResearchAndDevelopment","Security","SellDataToThirdParties","SellInsightsFromData","SellProductsToDataSubject","SellTargettedAdvertisements","ServiceOptimization","ServicePersonalization","ServiceProvision","SocialMediaMarketing","UsageAnalytics","UserInterfacePersonalisation"]},"processingCategories":{"type":"array","items":{"type":"string","enum":["Acquire","Adapt","Align","Alter","Analyse","Anonymise","AutomatedDecisionMaking","Collect","Combine","Consult","Copy","DataSource","Derive","Destruct","Disclose","DiscloseByTransmission","Disseminate","Erase","EvaluationScoring","InnovativeUseOfNewTechnologies","LargeScaleProcessing","MakeAvailable","MatchingCombining","Move","Obtain","Organise","Profiling","Pseudo-Anonymise","Record","Remove","Restrict","Retrieve","Share","Store","Structure","Systematic Monitoring","Transfer","Transform","Transmit"]}},"description":{"type":"array","items":{"$ref":"#/components/schemas/Description__2"}},"requiredDatasets":{"type":"array","items":{"type":"string"}},"storage":{"$ref":"#/components/schemas/Storage"},"recipients":{"type":"array","items":{"type":"string","enum":["Ours","Delivery","Same","Other recipient","Unrelated","Public"]}},"shareWith":{"type":"array","items":{"$ref":"#/components/schemas/ShareWith"}},"obligations":{"type":"array","items":{"$ref":"#/components/schemas/Obligation"}},"policyRef":{"type":"string"},"collectionMethod":{"type":"string"},"termination":{"type":"string"}}},"ServiceEntry":{"type":"object","properties":{"serviceId":{"type":"string"},"name":{"type":"string"},"identifier":{"type":"string"},"issued":{"type":"string"},"createdByUserId":{"type":"string"},"serviceDescriptionVersion":{"type":"string"},"serviceDescriptionSignature":{"type":"string"},"serviceIconUrl":{"type":"string"},"status":{"type":"string"},"supportedProfiles":{"type":"array","items":{"type":"string","enum":["Contract","Consenting","3rd party re-use","Notification","Objection"]}},"spatial":{"type":"string"},"lifeEvent":{"type":"string"},"businessEvent":{"type":"string"},"sector":{"type":"array","items":{"type":"string"}},"type":{"type":"array","items":{"type":"string"}},"thematicArea":{"type":"array","items":{"type":"string"}},"language":{"type":"array","items":{"type":"string"}},"hasCompetentAuthority":{"$ref":"#/components/schemas/HasCompetentAuthority"},"humanReadableDescription":{"type":"array","items":{"$ref":"#/components/schemas/HumanReadableDescription"}},"serviceInstance":{"$ref":"#/components/schemas/ServiceInstance"},"isDescribedAt":{"type":"array","items":{"$ref":"#/components/schemas/IsDescribedAt"}},"processingBases":{"type":"array","items":{"$ref":"#/components/schemas/ProcessingBasis"}},"role":{"type":"string","enum":["Sink","Source"]}}},"ServiceInstance":{"type":"object","properties":{"serviceProvider":{"$ref":"#/components/schemas/ServiceProvider"},"cert":{"$ref":"#/components/schemas/Cert"},"serviceUrls":{"$ref":"#/components/schemas/ServiceUrls"},"dataController":{"$ref":"#/components/schemas/DataController"}}},"ServiceProvider":{"type":"object","properties":{"businessId":{"type":"string"},"name":{"type":"string"},"address1":{"type":"string"},"address2":{"type":"string"},"postalcode":{"type":"string"},"city":{"type":"string"},"state":{"type":"string"},"country":{"type":"string"},"email":{"type":"string"},"phone":{"type":"string"},"jurisdiction":{"type":"string"}}},"ServiceUrls":{"type":"object","properties":{"domain":{"type":"string"},"libraryDomain":{"type":"string"},"loginUri":{"type":"string"},"linkingUri":{"type":"string"},"linkingRedirectUri":{"type":"string"},"objectionUri":{"type":"string"},"notificationUri":{"type":"string"}}},"ShareWith":{"type":"object","properties":{"orgName":{"type":"string"},"orgUrl":{"type":"string"},"businessType":{"type":"string","enum":["Profit","No profit"]},"required":{"type":"boolean"}}},"Storage":{"type":"object","properties":{"location":{"type":"string","enum":["Controller servers","Eu","Third countries","Our servers","Processor servers","Third party"]},"duration":{"type":"string","enum":["Business practices","Legal requirement","Stated purpose","Indefinitely"]}}},"Algorithm":{"type":"object","properties":{"name":{"type":"string"},"requirement":{"type":"string","enum":["REQUIRED","RECOMMENDED","OPTIONAL"]}}},"Base64":{"type":"object"},"Base64URL":{"type":"object"},"JOSEObjectType":{"type":"object","properties":{"type":{"type":"string"}}},"JWK":{"type":"object","properties":{"keyStore":{"type":"object","properties":{"type":{"type":"string"},"provider":{"type":"object","additionalProperties":{"type":"string"}}}},"private":{"type":"boolean"},"algorithm":{"$ref":"#/components/schemas/Algorithm"},"keyType":{"$ref":"#/components/schemas/KeyType"},"keyUse":{"$ref":"#/components/schemas/KeyUse"},"keyID":{"type":"string"},"parsedX509CertChain":{"type":"array","items":{"type":"object","properties":{"type":{"type":"string"},"subjectX500Principal":{"type":"object","properties":{"name":{"type":"string"},"encoded":{"type":"array","items":{"type":"string","format":"byte"}}}},"issuerX500Principal":{"type":"object","properties":{"name":{"type":"string"},"encoded":{"type":"array","items":{"type":"string","format":"byte"}}}},"signature":{"type":"array","items":{"type":"string","format":"byte"}},"basicConstraints":{"type":"integer","format":"int32"},"version":{"type":"integer","format":"int32"},"issuerDN":{"type":"object","properties":{"name":{"type":"string"}}},"subjectDN":{"type":"object","properties":{"name":{"type":"string"}}},"serialNumber":{"type":"integer"},"tbscertificate":{"type":"array","items":{"type":"string","format":"byte"}},"extendedKeyUsage":{"type":"array","items":{"type":"string"}},"sigAlgName":{"type":"string"},"notBefore":{"type":"string","format":"date-time"},"notAfter":{"type":"string","format":"date-time"},"subjectAlternativeNames":{"type":"array","items":{"type":"array","items":{"type":"object"}}},"issuerAlternativeNames":{"type":"array","items":{"type":"array","items":{"type":"object"}}},"sigAlgParams":{"type":"array","items":{"type":"string","format":"byte"}},"sigAlgOID":{"type":"string"},"issuerUniqueID":{"type":"array","items":{"type":"boolean"}},"subjectUniqueID":{"type":"array","items":{"type":"boolean"}},"keyUsage":{"type":"array","items":{"type":"boolean"}},"criticalExtensionOIDs":{"uniqueItems":true,"type":"array","items":{"type":"string"}},"nonCriticalExtensionOIDs":{"uniqueItems":true,"type":"array","items":{"type":"string"}},"encoded":{"type":"array","items":{"type":"string","format":"byte"}},"publicKey":{"type":"object","properties":{"encoded":{"type":"array","items":{"type":"string","format":"byte"}},"format":{"type":"string"},"algorithm":{"type":"string"}}}}}},"x509CertThumbprint":{"$ref":"#/components/schemas/Base64URL"},"x509CertSHA256Thumbprint":{"$ref":"#/components/schemas/Base64URL"},"requiredParams":{"type":"object","additionalProperties":{"type":"object"}},"x509CertURL":{"type":"string","format":"uri"},"x509CertChain":{"type":"array","items":{"$ref":"#/components/schemas/Base64"}},"keyOperations":{"uniqueItems":true,"type":"array","items":{"type":"string","enum":["sign","verify","encrypt","decrypt","wrapKey","unwrapKey","deriveKey","deriveBits"]}}}},"JWSAlgorithm":{"type":"object","properties":{"name":{"type":"string"},"requirement":{"type":"string","enum":["REQUIRED","RECOMMENDED","OPTIONAL"]}}},"JWSHeader":{"type":"object","properties":{"customParams":{"type":"object","additionalProperties":{"type":"object"}},"parsedBase64URL":{"$ref":"#/components/schemas/Base64URL"},"jwk":{"$ref":"#/components/schemas/JWK"},"algorithm":{"$ref":"#/components/schemas/JWSAlgorithm"},"keyID":{"type":"string"},"x509CertThumbprint":{"$ref":"#/components/schemas/Base64URL"},"x509CertSHA256Thumbprint":{"$ref":"#/components/schemas/Base64URL"},"jwkurl":{"type":"string","format":"uri"},"x509CertURL":{"type":"string","format":"uri"},"x509CertChain":{"type":"array","items":{"$ref":"#/components/schemas/Base64"}},"includedParams":{"uniqueItems":true,"type":"array","items":{"type":"string"}},"type":{"$ref":"#/components/schemas/JOSEObjectType"},"contentType":{"type":"string"},"criticalParams":{"uniqueItems":true,"type":"array","items":{"type":"string"}}}},"KeyType":{"type":"object","properties":{"value":{"type":"string"},"requirement":{"type":"string","enum":["REQUIRED","RECOMMENDED","OPTIONAL"]}}},"KeyUse":{"type":"object","properties":{"value":{"type":"string"}}},"ServiceLinkStatusRecordPayload":{"required":["iat","prev_record_id","record_id","sl_status","slr_id","surrogate_id","version"],"type":"object","properties":{"iat":{"type":"string","format":"date-time"},"version":{"type":"string"},"record_id":{"type":"string"},"surrogate_id":{"type":"string"},"slr_id":{"type":"string"},"sl_status":{"type":"string","enum":["Active","Removed"]},"prev_record_id":{"type":"string"}}},"ServiceLinkStatusRecordSigned":{"required":["header","payload","protected","signature"],"type":"object","properties":{"header":{"$ref":"#/components/schemas/JWSHeader"},"payload":{"$ref":"#/components/schemas/ServiceLinkStatusRecordPayload"},"signature":{"$ref":"#/components/schemas/Base64URL"},"protected":{"$ref":"#/components/schemas/Base64URL"}}},"ConsentForm":{"required":["data_controller","resource_set","service_description_signature","service_description_version","service_provider_business_id","sink_name","sink_service_id","surrogate_id","usage_rules"],"type":"object","properties":{"surrogate_id":{"type":"string"},"source_surrogate_id":{"type":"string"},"source_service_id":{"type":"string"},"sink_service_id":{"type":"string"},"source_name":{"type":"string"},"sink_name":{"type":"string"},"sink_library_domain_url":{"type":"string"},"source_library_domain_url":{"type":"string"},"source_humanreadable_descriptions":{"type":"array","items":{"$ref":"#/components/schemas/HumanReadableDescription"}},"sink_humanreadable_descriptions":{"type":"array","items":{"$ref":"#/components/schemas/HumanReadableDescription"}},"resource_set":{"$ref":"#/components/schemas/ResourceSet"},"usage_rules":{"$ref":"#/components/schemas/SinkUsageRules"},"jurisdiction":{"type":"string"},"data_controller":{"$ref":"#/components/schemas/DataController"},"service_description_version":{"type":"string"},"service_description_signature":{"type":"string"},"service_provider_business_id":{"type":"string"}}},"Dataset":{"required":["created","dataMappings","dataset_id","purposeId","purposeName"],"type":"object","properties":{"contactPoint":{"type":"string"},"description":{"type":"string"},"issued":{"type":"string"},"keyword":{"type":"array","items":{"type":"string"}},"purposeId":{"type":"string"},"purposeName":{"type":"string"},"language":{"type":"string"},"modified":{"type":"string"},"publisher":{"type":"string"},"serviceDataType":{"type":"string"},"spatial":{"type":"string"},"title":{"type":"string"},"dataStructureSpecification":{"type":"string"},"dataMappings":{"type":"array","items":{"$ref":"#/components/schemas/DataMapping"}},"created":{"type":"string","format":"date-time"},"dataset_id":{"type":"string"}}},"Policy":{"type":"object","properties":{"policyRef":{"type":"string"},"policyHash":{"type":"string"},"policyVersion":{"type":"string"}}},"ResourceSet":{"required":["datasets","rs_id"],"type":"object","properties":{"rs_id":{"type":"string"},"datasets":{"type":"array","items":{"$ref":"#/components/schemas/Dataset"}}}},"SinkUsageRules":{"required":["legalBasis","policy","processingCategories","purposeCategory","purposeDescription","purposeId","purposeName"],"type":"object","properties":{"purposeId":{"type":"string"},"purposeCategory":{"type":"string"},"purposeDescription":{"type":"array","items":{"$ref":"#/components/schemas/Description__2"}},"legalBasis":{"type":"string","enum":["Consent","Contract","Legal obligation","Vital interest","Public interest","Legitimate interest"]},"purposeName":{"type":"string"},"processingCategories":{"type":"array","items":{"type":"string","enum":["Acquire","Adapt","Align","Alter","Analyse","Anonymise","AutomatedDecisionMaking","Collect","Combine","Consult","Copy","DataSource","Derive","Destruct","Disclose","DiscloseByTransmission","Disseminate","Erase","EvaluationScoring","InnovativeUseOfNewTechnologies","LargeScaleProcessing","MakeAvailable","MatchingCombining","Move","Obtain","Organise","Profiling","Pseudo-Anonymise","Record","Remove","Restrict","Retrieve","Share","Store","Structure","Systematic Monitoring","Transfer","Transform","Transmit"]}},"policy":{"$ref":"#/components/schemas/Policy"},"storage":{"$ref":"#/components/schemas/Storage"},"recipients":{"type":"array","items":{"type":"string","enum":["Ours","Delivery","Same","Other recipient","Unrelated","Public"]}},"shareWith":{"type":"array","items":{"$ref":"#/components/schemas/ShareWith"}},"obligations":{"type":"array","items":{"$ref":"#/components/schemas/Obligation"}},"collectionMethod":{"type":"string"},"termination":{"type":"string"}}},"CommonPart":{"required":["consent_status","cr_id","data_controller","iat","jurisdiction","mat","operator","role","rs_description","service_description_signature","service_description_version","service_provider_business_id","slr_id","source_id","source_name","subject_humanreadable_descriptions","subject_id","subject_name","surrogate_id","version"],"type":"object","properties":{"iat":{"type":"string","format":"date-time"},"mat":{"type":"string","format":"date-time"},"nbf":{"type":"string","format":"date-time"},"exp":{"type":"string","format":"date-time"},"operator":{"type":"string"},"jurisdiction":{"type":"string"},"role":{"type":"string","enum":["Sink","Source"]},"version":{"type":"string"},"cr_id":{"type":"string"},"cr_pair_id":{"type":"string"},"surrogate_id":{"type":"string"},"rs_description":{"$ref":"#/components/schemas/RSDescription"},"slr_id":{"type":"string"},"source_id":{"type":"string"},"source_name":{"type":"string"},"subject_id":{"type":"string"},"subject_name":{"type":"string"},"subject_humanreadable_descriptions":{"type":"array","items":{"$ref":"#/components/schemas/HumanReadableDescription"}},"data_controller":{"$ref":"#/components/schemas/DataController"},"service_description_version":{"type":"string"},"service_description_signature":{"type":"string"},"service_provider_business_id":{"type":"string"},"consent_status":{"type":"string","enum":["Active","Disabled","Withdrawn"]},"consent_statuses_signature":{"$ref":"#/components/schemas/Base64URL"}}},"ConsentNotarizationPart":{"type":"object","properties":{"notarizationStatus":{"type":"boolean"},"notarizationHash":{"type":"string"},"notarizationTimestamp":{"type":"string","format":"date-time"}}},"ConsentRecordPayload":{"type":"object","properties":{"consentNotarization":{"$ref":"#/components/schemas/ConsentNotarizationPart"},"common_part":{"$ref":"#/components/schemas/CommonPart"},"role_specific_part":{"$ref":"#/components/schemas/ConsentRecordRoleSpecificPart"}}},"ConsentRecordRoleSpecificPart":{"required":["type"],"type":"object","properties":{"type":{"type":"string"}},"discriminator":{"propertyName":"type"}},"ConsentRecordSigned":{"required":["header","payload","protected","signature"],"type":"object","properties":{"header":{"$ref":"#/components/schemas/JWSHeader"},"payload":{"$ref":"#/components/schemas/ConsentRecordPayload"},"signature":{"$ref":"#/components/schemas/Base64URL"},"consentStatusList":{"type":"array","items":{"$ref":"#/components/schemas/ConsentStatusRecordSigned"}},"protected":{"$ref":"#/components/schemas/Base64URL"}}},"ConsentStatusRecordPayload":{"required":["consent_status","cr_id","iat","prev_record_id","record_id","surrogate_id","version"],"type":"object","properties":{"record_id":{"type":"string"},"version":{"type":"string"},"surrogate_id":{"type":"string"},"cr_id":{"type":"string"},"consent_status":{"type":"string","enum":["Active","Disabled","Withdrawn"]},"consent_resource_set":{"$ref":"#/components/schemas/ResourceSet"},"consent_usage_rules":{"$ref":"#/components/schemas/SinkUsageRules"},"iat":{"type":"string","format":"date-time"},"prev_record_id":{"type":"string"}}},"ConsentStatusRecordSigned":{"required":["header","payload","protected","signature"],"type":"object","properties":{"header":{"$ref":"#/components/schemas/JWSHeader"},"payload":{"$ref":"#/components/schemas/ConsentStatusRecordPayload"},"signature":{"$ref":"#/components/schemas/Base64URL"},"protected":{"$ref":"#/components/schemas/Base64URL"}}},"OtherPrimesInfo":{"type":"object","properties":{"factorCRTExponent":{"$ref":"#/components/schemas/Base64URL"},"factorCRTCoefficient":{"$ref":"#/components/schemas/Base64URL"},"primeFactor":{"$ref":"#/components/schemas/Base64URL"}}},"RSAKey":{"type":"object","properties":{"keyStore":{"type":"object","properties":{"type":{"type":"string"},"provider":{"type":"object","additionalProperties":{"type":"string"}}}},"private":{"type":"boolean"},"publicExponent":{"$ref":"#/components/schemas/Base64URL"},"modulus":{"$ref":"#/components/schemas/Base64URL"},"privateExponent":{"$ref":"#/components/schemas/Base64URL"},"firstFactorCRTExponent":{"$ref":"#/components/schemas/Base64URL"},"firstPrimeFactor":{"$ref":"#/components/schemas/Base64URL"},"secondPrimeFactor":{"$ref":"#/components/schemas/Base64URL"},"secondFactorCRTExponent":{"$ref":"#/components/schemas/Base64URL"},"firstCRTCoefficient":{"$ref":"#/components/schemas/Base64URL"},"otherPrimes":{"type":"array","items":{"$ref":"#/components/schemas/OtherPrimesInfo"}},"requiredParams":{"type":"object","additionalProperties":{"type":"object"}},"algorithm":{"$ref":"#/components/schemas/Algorithm"},"keyType":{"$ref":"#/components/schemas/KeyType"},"keyUse":{"$ref":"#/components/schemas/KeyUse"},"keyID":{"type":"string"},"parsedX509CertChain":{"type":"array","items":{"type":"object","properties":{"type":{"type":"string"},"subjectX500Principal":{"type":"object","properties":{"name":{"type":"string"},"encoded":{"type":"array","items":{"type":"string","format":"byte"}}}},"issuerX500Principal":{"type":"object","properties":{"name":{"type":"string"},"encoded":{"type":"array","items":{"type":"string","format":"byte"}}}},"signature":{"type":"array","items":{"type":"string","format":"byte"}},"basicConstraints":{"type":"integer","format":"int32"},"version":{"type":"integer","format":"int32"},"issuerDN":{"type":"object","properties":{"name":{"type":"string"}}},"subjectDN":{"type":"object","properties":{"name":{"type":"string"}}},"serialNumber":{"type":"integer"},"tbscertificate":{"type":"array","items":{"type":"string","format":"byte"}},"extendedKeyUsage":{"type":"array","items":{"type":"string"}},"sigAlgName":{"type":"string"},"notBefore":{"type":"string","format":"date-time"},"notAfter":{"type":"string","format":"date-time"},"subjectAlternativeNames":{"type":"array","items":{"type":"array","items":{"type":"object"}}},"issuerAlternativeNames":{"type":"array","items":{"type":"array","items":{"type":"object"}}},"sigAlgParams":{"type":"array","items":{"type":"string","format":"byte"}},"sigAlgOID":{"type":"string"},"issuerUniqueID":{"type":"array","items":{"type":"boolean"}},"subjectUniqueID":{"type":"array","items":{"type":"boolean"}},"keyUsage":{"type":"array","items":{"type":"boolean"}},"criticalExtensionOIDs":{"uniqueItems":true,"type":"array","items":{"type":"string"}},"nonCriticalExtensionOIDs":{"uniqueItems":true,"type":"array","items":{"type":"string"}},"encoded":{"type":"array","items":{"type":"string","format":"byte"}},"publicKey":{"type":"object","properties":{"encoded":{"type":"array","items":{"type":"string","format":"byte"}},"format":{"type":"string"},"algorithm":{"type":"string"}}}}}},"x509CertThumbprint":{"$ref":"#/components/schemas/Base64URL"},"x509CertSHA256Thumbprint":{"$ref":"#/components/schemas/Base64URL"},"x509CertURL":{"type":"string","format":"uri"},"x509CertChain":{"type":"array","items":{"$ref":"#/components/schemas/Base64"}},"keyOperations":{"uniqueItems":true,"type":"array","items":{"type":"string","enum":["sign","verify","encrypt","decrypt","wrapKey","unwrapKey","deriveKey","deriveBits"]}}}},"RSDescription":{"required":["resource_set"],"type":"object","properties":{"resource_set":{"$ref":"#/components/schemas/ResourceSet"}}},"ServicePopKey":{"required":["jwk","operator_id","service_id","surrogate_id"],"type":"object","properties":{"operator_id":{"type":"string"},"service_id":{"type":"string"},"surrogate_id":{"type":"string"},"jwk":{"$ref":"#/components/schemas/RSAKey"}}},"DataTransferResponse":{"type":"object","properties":{"data":{"type":"object","additionalProperties":{"type":"object"}}}},"DataTransferRequest":{"required":["cr_id","rs_id","surrogate_id"],"type":"object","properties":{"surrogate_id":{"type":"string"},"cr_id":{"type":"string"},"rs_id":{"type":"string"},"dataset_id":{"type":"string"}}},"SurrogateIdResponse":{"type":"object","properties":{"surrogate_id":{"type":"string"}}},"ServiceSignKey":{"required":["jwk","kid","service_id"],"type":"object","properties":{"kid":{"type":"string"},"service_id":{"type":"string"},"jwk":{"$ref":"#/components/schemas/RSAKey"}}},"UserSurrogateIdLink":{"required":["operatorId","serviceId","surrogateId","userId"],"type":"object","properties":{"userId":{"type":"string"},"surrogateId":{"type":"string"},"serviceId":{"type":"string"},"operatorId":{"type":"string"},"created":{"type":"string","format":"date-time"}}},"ServiceLinkRecordDoubleSigned":{"required":["payload","signatures"],"type":"object","properties":{"payload":{"$ref":"#/components/schemas/ServiceLinkRecordPayload"},"signatures":{"type":"array","items":{"$ref":"#/components/schemas/ServiceLinkRecordSignature"}},"serviceLinkStatuses":{"type":"array","items":{"$ref":"#/components/schemas/ServiceLinkStatusRecordSigned"}}}},"ServiceLinkRecordPayload":{"required":["iat","link_id","operator_id","operator_key","service_description_version","service_id","service_name","service_uri","surrogate_id","version"],"type":"object","properties":{"iat":{"type":"string","format":"date-time"},"version":{"type":"string"},"link_id":{"type":"string"},"operator_id":{"type":"string"},"service_id":{"type":"string"},"service_uri":{"type":"string"},"service_name":{"type":"string"},"pop_key":{"$ref":"#/components/schemas/ServicePopKey"},"service_description_version":{"type":"string"},"surrogate_id":{"type":"string"},"operator_key":{"$ref":"#/components/schemas/RSAKey"},"cr_keys":{"type":"array","items":{"$ref":"#/components/schemas/RSAKey"}}}},"ServiceLinkRecordSignature":{"required":["header","protected","signature"],"type":"object","properties":{"header":{"$ref":"#/components/schemas/JWSHeader"},"signature":{"$ref":"#/components/schemas/Base64URL"},"protected":{"$ref":"#/components/schemas/Base64URL"}}},"FinalLinkingResponse":{"required":["code","data"],"type":"object","properties":{"code":{"type":"string"},"data":{"$ref":"#/components/schemas/LinkingResponseData"}}},"LinkingResponseData":{"required":["slr","ssr"],"type":"object","properties":{"slr":{"$ref":"#/components/schemas/ServiceLinkRecordDoubleSigned"},"ssr":{"$ref":"#/components/schemas/ServiceLinkStatusRecordSigned"}}},"StartLinkingRequest":{"required":["code","operator_id","return_url","service_id","surrogate_id"],"type":"object","properties":{"code":{"type":"string"},"surrogate_id":{"type":"string"},"operator_id":{"type":"string"},"service_id":{"type":"string"},"return_url":{"type":"string"}}},"ChangeConsentStatusRequest":{"required":["request_from","resource_set","usage_rules"],"type":"object","properties":{"status":{"type":"string","enum":["Active","Disabled","Withdrawn"]},"resource_set":{"$ref":"#/components/schemas/ResourceSet"},"usage_rules":{"$ref":"#/components/schemas/SinkUsageRules"},"request_from":{"type":"string","enum":["Service","Operator"]}}},"ServiceLinkRecordAccountSigned":{"required":["header","payload","protected","signature"],"type":"object","properties":{"payload":{"$ref":"#/components/schemas/ServiceLinkRecordPayload"},"header":{"$ref":"#/components/schemas/JWSHeader"},"signature":{"$ref":"#/components/schemas/Base64URL"},"protected":{"$ref":"#/components/schemas/Base64URL"}}},"ServiceSignSlrRequest":{"required":["account_signed_slr","code","operator_id","surrogate_id"],"type":"object","properties":{"account_signed_slr":{"$ref":"#/components/schemas/ServiceLinkRecordAccountSigned"},"surrogate_id":{"type":"string"},"operator_id":{"type":"string"},"code":{"type":"string"}}},"OperatorDescription":{"required":["operatorId","operatorUrls"],"type":"object","properties":{"operatorId":{"type":"string"},"serviceProvider":{"$ref":"#/components/schemas/ServiceProvider"},"operatorServiceDescriptionVersion":{"type":"string"},"supportedProfiles":{"type":"array","items":{"type":"string","enum":["Contract","Consenting","3rd party re-use","Notification","Objection"]}},"cert":{"$ref":"#/components/schemas/Cert"},"keyPair":{"$ref":"#/components/schemas/RSAKey"},"operatorUrls":{"$ref":"#/components/schemas/OperatorUrls"},"createdOnDate":{"type":"string","format":"date-time"},"createdByUserId":{"type":"string"}}},"OperatorUrls":{"required":["domain","linkingRedirectUri","linkingUri"],"type":"object","properties":{"domain":{"type":"string"},"linkingUri":{"type":"string"},"linkingRedirectUri":{"type":"string"}}}},"securitySchemes":{"bearer-key":{"type":"http","scheme":"bearer","bearerFormat":"token"}}}}