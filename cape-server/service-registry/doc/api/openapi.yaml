{"openapi":"3.0.1","info":{"title":"CaPe API - Service Registry","description":"Servicve Registry APIs used to manage Service entry descriptions and get data mappings and reports.","version":"2.0"},"servers":[{"url":"http://localhost:8088/service-registry","description":"Generated server url"}],"security":[{"bearer-key":[]}],"tags":[{"name":"Service Entry","description":"Service entry Description APIs to get and manage service entry descriptions."},{"name":"Service Dataset Data Mapping","description":"APIs to get Data Mapping for Services Datasets"},{"name":"Service Report","description":"Service Report APIs about Service descriptions."}],"paths":{"/api/v2/services":{"get":{"tags":["Service Entry"],"summary":"Get all the Service Entry descriptions. Optionally return only services registered to Cape, namely having not null Cert field","description":"Get all the registered services. Optionally filter also by by Service Name, Service Url or Service Provider Business Id.","operationId":"getServices","parameters":[{"name":"serviceName","in":"query","required":false,"schema":{"type":"string"}},{"name":"serviceUrl","in":"query","required":false,"schema":{"type":"string"}},{"name":"businessId","in":"query","required":false,"schema":{"type":"string"}},{"name":"onlyRegistered","in":"query","required":false,"schema":{"type":"boolean","default":false}}],"responses":{"409":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"Returns the list of all registered Service Entry descriptions","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ServiceEntry"}}}}}}},"post":{"tags":["Service Entry"],"summary":"Create a new Service Entry description.","operationId":"createService","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ServiceEntry"}}},"required":true},"responses":{"409":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"201":{"description":"Returns 201 Created with the created Service Entry.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ServiceEntry"}}}}}}},"/api/v2/services/{serviceId}/purposes/{purposeId}/dataMappings":{"get":{"tags":["Service Dataset Data Mapping"],"summary":"Get the Data Mapping list of the specified Dataset and Service","operationId":"getDataMappingListByServiceIdAndPurposeId","parameters":[{"name":"serviceId","in":"path","required":true,"schema":{"type":"string"}},{"name":"purposeId","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"409":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"Returns the requested Service Entry","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ServiceEntry"}}}}}}},"/api/v2/services/{serviceId}/purposes/{purposeId}":{"get":{"tags":["Service Entry"],"summary":"Get the ProcessingBasis of Service with input Service Id and Purpose Id","operationId":"getProcessingBasisByServiceIdAndPurposeId","parameters":[{"name":"serviceId","in":"path","required":true,"schema":{"type":"string"}},{"name":"purposeId","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"409":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"Returns the requested ProcessingBasis","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProcessingBasis"}}}}}}},"/api/v2/services/{serviceId}/datasets/{datasetId}/dataMappings":{"get":{"tags":["Service Dataset Data Mapping"],"summary":"Get the Data Mapping list of the specified Dataset and Service","operationId":"getDataMappingListByServiceIdAndDatasetId","parameters":[{"name":"serviceId","in":"path","required":true,"schema":{"type":"string"}},{"name":"datasetId","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"409":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"Returns the requested Service Entry","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/DataMapping"}}}}}}}},"/api/v2/services/count":{"get":{"tags":["Service Entry"],"summary":"Get the count of the registered Service Entry descriptions.","operationId":"getServicesCount","parameters":[{"name":"onlyRegistered","in":"query","required":false,"schema":{"type":"boolean","default":false}}],"responses":{"409":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"Returns the requested Service Entry","content":{"text/plain":{"schema":{"type":"string"}}}}}}},"/api/v2/services/{serviceId}":{"get":{"tags":["Service Entry"],"summary":"Get the Service Entry description by Service Id. (Registered to CaPe or not)","operationId":"getServiceById","parameters":[{"name":"serviceId","in":"path","required":true,"schema":{"type":"string"}},{"name":"onlyRegistered","in":"query","required":false,"schema":{"type":"boolean","default":false}}],"responses":{"409":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"Returns the requested Service Entry","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ServiceEntry"}}}}}},"put":{"tags":["Service Entry"],"summary":"Update Service Entry description, by replacing the existing one","operationId":"updateService","parameters":[{"name":"serviceId","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ServiceEntry"}}},"required":true},"responses":{"409":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"Returns the updated Service Entry.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ServiceEntry"}}}}}},"delete":{"tags":["Service Entry"],"summary":"Delete CaPe Account by Id or Username. Optionally deletes only the Cert field, in order to be considered unregistered by CaPe.","operationId":"deleteService","parameters":[{"name":"serviceId","in":"path","required":true,"schema":{"type":"string"}},{"name":"deleteOnlyCertificate","in":"query","required":false,"schema":{"type":"boolean","default":false}}],"responses":{"409":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"204":{"description":"Returns No Content.","content":{"*/*":{"schema":{"type":"object"}}}}}}},"/api/v2/serviceReport":{"get":{"tags":["Service Dataset Data Mapping"],"summary":"Get the Service Report, grouped by input criteria","operationId":"getServiceReport","parameters":[{"name":"groupBy","in":"query","required":true,"schema":{"type":"string","enum":["type","sector"]}}],"responses":{"409":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"default response","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"Returns the requested Service Report","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ServiceReport"}}}}}}}}},"components":{"schemas":{"ApiSubError":{"required":["type"],"type":"object","properties":{"type":{"type":"string"}},"discriminator":{"propertyName":"type"}},"ErrorResponse":{"type":"object","properties":{"status":{"type":"string","enum":["100 CONTINUE","101 SWITCHING_PROTOCOLS","102 PROCESSING","103 CHECKPOINT","200 OK","201 CREATED","202 ACCEPTED","203 NON_AUTHORITATIVE_INFORMATION","204 NO_CONTENT","205 RESET_CONTENT","206 PARTIAL_CONTENT","207 MULTI_STATUS","208 ALREADY_REPORTED","226 IM_USED","300 MULTIPLE_CHOICES","301 MOVED_PERMANENTLY","302 FOUND","302 MOVED_TEMPORARILY","303 SEE_OTHER","304 NOT_MODIFIED","305 USE_PROXY","307 TEMPORARY_REDIRECT","308 PERMANENT_REDIRECT","400 BAD_REQUEST","401 UNAUTHORIZED","402 PAYMENT_REQUIRED","403 FORBIDDEN","404 NOT_FOUND","405 METHOD_NOT_ALLOWED","406 NOT_ACCEPTABLE","407 PROXY_AUTHENTICATION_REQUIRED","408 REQUEST_TIMEOUT","409 CONFLICT","410 GONE","411 LENGTH_REQUIRED","412 PRECONDITION_FAILED","413 PAYLOAD_TOO_LARGE","413 REQUEST_ENTITY_TOO_LARGE","414 URI_TOO_LONG","414 REQUEST_URI_TOO_LONG","415 UNSUPPORTED_MEDIA_TYPE","416 REQUESTED_RANGE_NOT_SATISFIABLE","417 EXPECTATION_FAILED","418 I_AM_A_TEAPOT","419 INSUFFICIENT_SPACE_ON_RESOURCE","420 METHOD_FAILURE","421 DESTINATION_LOCKED","422 UNPROCESSABLE_ENTITY","423 LOCKED","424 FAILED_DEPENDENCY","425 TOO_EARLY","426 UPGRADE_REQUIRED","428 PRECONDITION_REQUIRED","429 TOO_MANY_REQUESTS","431 REQUEST_HEADER_FIELDS_TOO_LARGE","451 UNAVAILABLE_FOR_LEGAL_REASONS","500 INTERNAL_SERVER_ERROR","501 NOT_IMPLEMENTED","502 BAD_GATEWAY","503 SERVICE_UNAVAILABLE","504 GATEWAY_TIMEOUT","505 HTTP_VERSION_NOT_SUPPORTED","506 VARIANT_ALSO_NEGOTIATES","507 INSUFFICIENT_STORAGE","508 LOOP_DETECTED","509 BANDWIDTH_LIMIT_EXCEEDED","510 NOT_EXTENDED","511 NETWORK_AUTHENTICATION_REQUIRED"]},"timestamp":{"type":"string","format":"date-time"},"message":{"type":"string"},"debugMessage":{"type":"string"},"cause":{"type":"string"},"subErrors":{"type":"array","items":{"$ref":"#/components/schemas/ApiSubError"}}}},"Cert":{"type":"object","properties":{"x5u":{"type":"string"},"x5c":{"type":"array","items":{"type":"string"}}}},"DataController":{"type":"object","properties":{"piiController":{"type":"string"},"onBehalf":{"type":"boolean"},"org":{"type":"string"},"contact":{"type":"string"},"address":{"type":"string"},"email":{"type":"string"},"phone":{"type":"string"},"operatorName":{"type":"string"}}},"DataMapping":{"type":"object","properties":{"property":{"type":"string"},"conceptId":{"type":"string"},"name":{"type":"string"},"type":{"type":"string"},"required":{"type":"boolean"}}},"DatasetSchema":{"type":"object","properties":{"context":{"type":"string"},"type":{"type":"string"},"id":{"type":"string"}}},"Description":{"type":"object","properties":{"locale":{"type":"string"},"description":{"type":"string"},"keyword":{"type":"array","items":{"type":"string"}}}},"Description__1":{"type":"object","properties":{"locale":{"type":"string"},"description":{"type":"string"}}},"Description__2":{"type":"object","properties":{"locale":{"type":"string"},"title":{"type":"string"},"description":{"type":"string"},"descriptionUrl":{"type":"string"},"iconUrl":{"type":"string"}}},"Distribution":{"type":"object","properties":{"distributionId":{"type":"string"},"accessUrl":{"type":"string"},"description":{"type":"array","items":{"$ref":"#/components/schemas/Description__1"}},"format":{"type":"string"}}},"HasCompetentAuthority":{"type":"object","properties":{"prefLabel":{"type":"string"},"spatial":{"type":"string"}}},"HumanReadableDescription":{"type":"object","properties":{"locale":{"type":"string"},"description":{"type":"string"},"keywords":{"type":"array","items":{"type":"string"}}}},"IsDescribedAt":{"type":"object","properties":{"datasetId":{"type":"string"},"description":{"type":"array","items":{"$ref":"#/components/schemas/Description"}},"datasetSchema":{"$ref":"#/components/schemas/DatasetSchema"},"dataStructureSpecification":{"type":"string"},"distribution":{"$ref":"#/components/schemas/Distribution"},"dataMapping":{"type":"array","items":{"$ref":"#/components/schemas/DataMapping"}}}},"Obligation":{"type":"object","properties":{"event":{"type":"string"},"activity":{"type":"string"}}},"ProcessingBasis":{"type":"object","properties":{"purposeId":{"type":"string"},"purposeName":{"type":"string"},"legalBasis":{"type":"string","enum":["Consent","Contract","Legal obligation","Vital interest","Public interest","Legitimate interest"]},"purposeCategory":{"type":"string","enum":["AcademicResearch","AccessControl","Advertising ","CommercialInterest","CommercialResearch","CommunicationForCustomerCare","CreateEventRecommendations","CreatePersonalizedRecommendations","CreateProductRecommendations","CustomerCare","DeliveryOfGoods","DirectMarketing","FraudPreventionAndDetection","IdentityVerification","ImproveExistingProductsAndServices","ImproveInternalCRMProcesses","IncreaseServiceRobustness","InternalResourceOptimisation","LegalCompliance","Marketing","NonCommercialResearch","OptimisationForConsumer","OptimisationForController","OptimiseUserInterface","Payment","PersonalisedAdvertising","PersonalisedBenefits","RegistrationAuthentication","ResearchAndDevelopment","Security","SellDataToThirdParties","SellInsightsFromData","SellProductsToDataSubject","SellTargettedAdvertisements","ServiceOptimization","ServicePersonalization","ServiceProvision","SocialMediaMarketing","UsageAnalytics","UserInterfacePersonalisation"]},"processingCategories":{"type":"array","items":{"type":"string","enum":["Acquire","Adapt","Align","Alter","Analyse","Anonymise","AutomatedDecisionMaking","Collect","Combine","Consult","Copy","DataSource","Derive","Destruct","Disclose","DiscloseByTransmission","Disseminate","Erase","EvaluationScoring","InnovativeUseOfNewTechnologies","LargeScaleProcessing","MakeAvailable","MatchingCombining","Move","Obtain","Organise","Profiling","Pseudo-Anonymise","Record","Remove","Restrict","Retrieve","Share","Store","Structure","SystematicMonitoring","Transfer","Transform","Transmit"]}},"description":{"type":"array","items":{"$ref":"#/components/schemas/Description__2"}},"requiredDatasets":{"type":"array","items":{"type":"string"}},"storage":{"$ref":"#/components/schemas/Storage"},"recipients":{"type":"array","items":{"type":"string","enum":["Ours","Delivery","Same","Other recipient","Unrelated","Public"]}},"shareWith":{"type":"array","items":{"$ref":"#/components/schemas/ShareWith"}},"obligations":{"type":"array","items":{"$ref":"#/components/schemas/Obligation"}},"policyRef":{"type":"string"},"collectionMethod":{"type":"string"},"collectionOperator":{"type":"string"},"termination":{"type":"string"}}},"ServiceEntry":{"type":"object","properties":{"serviceId":{"type":"string"},"name":{"type":"string"},"identifier":{"type":"string"},"issued":{"type":"string"},"createdByUserId":{"type":"string"},"serviceDescriptionVersion":{"type":"string"},"serviceDescriptionSignature":{"type":"string"},"serviceIconUrl":{"type":"string"},"status":{"type":"string"},"supportedProfiles":{"type":"array","items":{"type":"string","enum":["Contract","Consenting","3rd party re-use","Notification","Objection"]}},"spatial":{"type":"string"},"lifeEvent":{"type":"string"},"businessEvent":{"type":"string"},"sector":{"type":"array","items":{"type":"string"}},"type":{"type":"array","items":{"type":"string"}},"thematicArea":{"type":"array","items":{"type":"string"}},"language":{"type":"array","items":{"type":"string"}},"hasCompetentAuthority":{"$ref":"#/components/schemas/HasCompetentAuthority"},"humanReadableDescription":{"type":"array","items":{"$ref":"#/components/schemas/HumanReadableDescription"}},"serviceInstance":{"$ref":"#/components/schemas/ServiceInstance"},"isDescribedAt":{"type":"array","items":{"$ref":"#/components/schemas/IsDescribedAt"}},"processingBases":{"type":"array","items":{"$ref":"#/components/schemas/ProcessingBasis"}},"role":{"type":"string","enum":["Sink","Source"]}}},"ServiceInstance":{"type":"object","properties":{"serviceProvider":{"$ref":"#/components/schemas/ServiceProvider"},"cert":{"$ref":"#/components/schemas/Cert"},"serviceUrls":{"$ref":"#/components/schemas/ServiceUrls"},"dataController":{"$ref":"#/components/schemas/DataController"}}},"ServiceProvider":{"type":"object","properties":{"businessId":{"type":"string"},"name":{"type":"string"},"address1":{"type":"string"},"address2":{"type":"string"},"postalcode":{"type":"string"},"city":{"type":"string"},"state":{"type":"string"},"country":{"type":"string"},"email":{"type":"string"},"phone":{"type":"string"},"jurisdiction":{"type":"string"}}},"ServiceUrls":{"type":"object","properties":{"domain":{"type":"string"},"libraryDomain":{"type":"string"},"loginUri":{"type":"string"},"linkingUri":{"type":"string"},"linkingRedirectUri":{"type":"string"},"objectionUri":{"type":"string"},"notificationUri":{"type":"string"}}},"ShareWith":{"type":"object","properties":{"orgName":{"type":"string"},"orgUrl":{"type":"string"},"businessType":{"type":"string","enum":["Profit","No profit"]},"required":{"type":"boolean"}}},"Storage":{"type":"object","properties":{"location":{"type":"string","enum":["Controller servers","Eu","Third countries","Our servers","Processor servers","Third party"]},"duration":{"type":"string","enum":["Business practices","Legal requirement","Stated purpose","Indefinitely"]}}},"ServiceReport":{"type":"object","properties":{"category":{"type":"string"},"count":{"type":"integer","format":"int32"},"total":{"type":"integer","format":"int32"}}}},"securitySchemes":{"bearer-key":{"type":"http","scheme":"bearer","bearerFormat":"token"}}}}